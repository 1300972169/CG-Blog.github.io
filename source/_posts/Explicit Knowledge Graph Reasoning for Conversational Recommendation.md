---
title: Explicit Knowledge Graph Reasoning for Conversational Recommendation
tags:
  - 对话
  - 推荐
  - 图谱
  - 数据挖掘
categories:
  - 推荐系统
  - 对话系统
  - 知识图谱
mathjax: true
description: 对话推荐系统
abbrlink: KECR
date: 2023-11-05 19:47:57
---
# 一、 摘要
## 1.1 研究背景
&emsp;&emsp;传统的推荐系统(RS)纯粹根据历史交互记录来估算用户对项目的偏好，因此无法捕捉细粒度但动态的用户兴趣，用户只能被动地接受推荐。最近出现的对话式推荐系统（CRSs）解决了这些局限性，它使推荐系统能够与用户互动，通过一连串的说明性问题获得用户当前的偏好
## 1.2 研究目的
&emsp;&emsp;尽管会话推荐系统取得了一些进展，但现有的解决方案在以下两个方面还远远不能令人满意：
&emsp;&emsp;（1）当前的 CRS 通常要求每个用户在获得最终推荐之前回答大量的澄清问题，这损害了用户体验；
&emsp;&emsp;（2）明确提及的属性和项目的学习表示之间存在语义差距。
## 1.3 解决方案
&emsp;&emsp;针对 1.2 提出的问题，作者引入了知识图谱（KG）作为理解和推理用户偏好的辅助信息，并提出了一种新的 CRS 框架，即知识增强对话推理（KECR）系统。由于用户可以通过属性和项目两个层面的表达来反映自己的偏好，KECR通过在KG中嵌入结构化知识，缩小了两个层面之间的语义差距。同时，KECR 利用 KG 内部的连通性对用户需求进行显式推理，使模型不再依赖于用户对澄清问题的反馈。KECR 可以找到一个突出的推理链，使推荐可解释、更合理，并使对话过程更流畅，从而带来更好的用户体验和对话推荐的准确性。
# 二、相关工作
## 2.1 知识图谱推理(Knowledge Graph Reasoning)
&emsp;&emsp;前期研究工作主要集中在对知识图谱进行多跳推理，以支持问题解答任务通过实体图或概念网来增强查询的语义表示，然后将其输入数据库，以促进基于相似性的检索。由于项目预测性能优越，一些推荐系统利用**KG嵌入技术**在推荐过程中改进项目嵌入，但是这种方法存在弊端，无法明确利用图中的连接信息，进而导致**可解释性的损失**；为了解决这个问题，人们提出了几种**基于路径的方法**。基于路径的方法旨在利用知识图谱中实体之间的联系，探索用户与推荐项目之间的突出路径[13, 56]。然而，这些方法缺乏获取用户需求的交互式方法，而且其推理过程仅限于预定义的元路径，无法根据用户的新输入进行动态改进 [42]。因此，它们的性能在很大程度上依赖于元路径工程的附加领域知识，而这是相当耗费人力的。
&emsp;&emsp;通过前人的研究，在知识图谱（KG）上执行**显式推理**已被证明是检索用户所需项目或答案的有效解决方案。
![KG Reasoning graph](../assets/image/KECR/KG%20Reasoning.png)

## 2.2 对话推荐(Conversational Recommendation)
&emsp;&emsp;CRS 已成为连接用户与系统之间互动的一种极具吸引力的方法，可通过可解释的准确推荐满足用户的实时需求。这一新兴研究课题源于面向任务的对话系统，该系统在多轮对话中帮助用户完成与推荐相关的任务。CRS 的传统设计遵循 SAUA 方式，即由 DC 针对预先定义的属性提出一系列说明性问题，以收集用户的明确偏好，并使用基于检索/协作过滤（CF）的推荐方法[14]推导出个性化推荐。这类方法的主要局限性在于，现实世界的应用场景包含大量可用于提出澄清问题的候选属性。因此，用户在获得最终推荐之前可能需要回答许多澄清问题，这极大地损害了用户体验。此外，这些方法中的对话行为和内容也受到严格限制。用户和 CRS 只能就用户对一组固定属性的偏好进行交互，CRS 直接给出推荐而不作任何解释。这就导致了语篇理解中的语义空白，尤其是当用户同时反映其对项目和属性的偏好时。
&emsp;&emsp;最近的一些方法采用知识图谱（KG）来丰富会话信息，以弥补理解过程中的语义空白。例如，利用项目属性图将分层信息与推荐和对话生成过程有效地结合起来。正如第 1 节中所讨论的，大多数现有的相关工作都没有充分利用知识图谱的优势（例如，学习从知识图谱中检索到的子图的隐式表示）。作者认为，知识图谱的连接性信息是理解用户偏好的关键信息。对知识图谱进行显式推理可以更好地发挥 CRS 的优势。为此，作者通过在知识图谱上明确推理用户偏好，设计了一种新颖的会话推荐系统。因此，作者的模型能够高效、精确地学习用户偏好，并为生成回复提供合理的指导。
![KECR components](../assets/image/KECR/KECR%20components%20.png)
## 2.3 静态语境信息建模(Static Context Information Modelling)
&emsp;&emsp;用户偏好的多样化表达（即项目级和属性级表达）使得理解用户话语中的潜在兴趣变得困难，从而阻碍了 CRS 推导出准确的建议和合适的对话回应。为改进这个问题，作者引入一个KG来丰富用户表达的语义，从而挖掘出用户在项目和属性层面的偏好之间的关联。然后，采用预先训练好的语言模型来学习对话语境的语义表征。
### 2.3.1 知识图谱嵌入(Knowledge Graph Embedding)
为CRS构建知识图谱，作者在原始的项目数据(DBpedia)上进行了以下修改：
&emsp;&emsp;(1) :从 DBpedia 中重建了一个子图谱，该图谱只包含出现在语料库中的项目实体。
&emsp;&emsp;(2) :原始的 DBpedia 只包含从项目到其相应属性的定向链接，这不足以在推荐上下文中对 KG 进行嵌入和推理。因此将项目与属性的关系扩展为双向关系，并添加了从通用类别（如电影类型和上映日期）到其值的新链接，以补偿 KG 中的信息。
&emsp;&emsp;通过对GCN(图卷积网络)的改进得到了R-GCN,它通过特定关系的权重矩阵对 GCN 进行了扩展，以更精细的粒度学习实体表征。在第$(l+1) -th$ 层，每个实体 $v∈V$ 的嵌入都是通过传播其单跳（one-hop）邻居的信息来学习的：
$$e^{l+1}_v =\sigma(\sum_{r∈R}\sum_{v^{\prime}∈N_r (v)} \frac{1}{z^{r}_v}W^{l}_rW^{l}_{v^{\prime}}+W^{l}_{0}W^{l}_v)$$
其中，$σ$是sigmoid 函数，$N_r(v)$ 表示 $v$ 在关系 $r∈R$ 下的邻居实体集，$z_r v$ 是归一化因子，$W^l_r$ 和 $W^l_0$ 分别是第 $l$ 层用于整合特定关系邻居和自循环的可学习权重矩阵,将最后一层的实体嵌入表示为 $e_v$，用于后续计算。
### 2.3.2 对话语境嵌入(Conversation Context Embedding)
&emsp;&emsp;
### 2.3.3 通过交互信息估计学习嵌入(Learning Embeddings via Mutual Information Estimation)&emsp;&emsp;